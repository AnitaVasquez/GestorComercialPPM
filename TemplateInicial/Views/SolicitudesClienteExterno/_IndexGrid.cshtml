@model IEnumerable<GestionPPM.Entidades.Modelo.SolicitudClienteExternoInfo>

@{
    var acciones = (List<string>)ViewBag.AccionesUsuario;
}

@(Html
                            .Grid(Model)
                            .Build(columns =>
                            {
                                columns.Add(model => model.fecha_hora_solicitud).Titled("Fecha Inicio").Formatted("{0:d}").AppendCss("celda-grande");
                                columns.Add(model => model.FechaFinalizacionSolicitud.Year < 2000 ? string.Empty : model.FechaFinalizacionSolicitud.ToString("dd/MM/yyyy")).Titled("Fecha Fin").Formatted("{0:d}").AppendCss("celda-grande");
                                columns.Add(model => model.CodigoSolicitud).Titled("N. Solicitud").AppendCss("celda-grande");
                                columns.Add(model => model.NombresCompletosSolicitante).Titled("Ejecutivo/a").AppendCss("celda-grande");
                                columns.Add(model => model.Area).Titled("Área Solicitante").AppendCss("celda-grande");
                                columns.Add(model => model.NombreProyectoSolicituCliente).Titled("Asunto").AppendCss("celda-grande");
                                columns.Add(model => model.TextoCatalogoTipo).Titled("Tipo de Solicitud").AppendCss("celda-grande");
                                columns.Add(model => model.TextoCatalogoSubTipo).Titled("Subtipo de Solicitud").AppendCss("celda-grande");
                                columns.Add(model => model.mkt).Titled("Referencia Cliente").AppendCss("celda-grande");
                                columns.Add(model => model.EstadoSolicitud).Titled("Estado Solicitud").AppendCss("celda-grande");
                                columns.Add(model => model.codigo_cotizacion).Titled("Código de Cotización").AppendCss("celda-grande");
                                columns.Add(model => model.NombreProyectoCodigoCotizacion).Titled("Nombre de Proyecto").AppendCss("celda-grande");
                                columns.Add(model => model.VersionCodigoCotizacion).Titled("Versión").AppendCss("celda-grande");
                                columns.Add(model => model.EstatusCodigo).Titled("Estado Cotización").AppendCss("celda-grande");
                                columns.Add(model => model.TextoCatalogoMarca).Titled("Marca").Encoded(false).RenderedAs(model => model.TextoCatalogoTipo == "MANTENIMIENTO" ? "<p>" + model.Portales + "</p>" : "<p>" + model.TextoCatalogoMarca + "</p>").Css("celda-grande");
                                columns.Add(model => model.Urgente).Titled("Tipo").Encoded(false).RenderedAs(model => model.Urgente == true ? "<p style='color: red'>" + "URGENTE" + "</p>" : "<p style='color: green'>" + "NORMAL" + "</p>").Css("celda-centrada");
                                columns.Add(model => " <a title='Ver Adjuntos.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_Adjuntos", "SolicitudesClienteExterno") + "\");' class='abrirEnlace " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-ADJUNTOS") + "' id='ver-adjuntos-actas' data-id=\"" + model.id_solicitud + "\"><i class='glyphicon glyphicon-folder-open' aria-hidden='true'></i></a>").Titled("Adjuntos").AppendCss("celda-grande").Encoded(false);

                                //columns.Add(model => " <a title='Ver Actas.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_AdjuntosActas", "SolicitudesClienteExterno") + "\");' class='abrirEnlace' id='ver-adjuntos-actas' data-id=\"" + model.id_solicitud + "\"><i class='glyphicon glyphicon-folder-open' aria-hidden='true'></i></a>").Titled("Actas").AppendCss("celda-grande").Encoded(false);
                                //columns.Add(model => " <a title='Ver archivos adjuntos solicitud.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_AdjuntarArchivos", "SolicitudesClienteExterno") + "\");' class='abrirEnlace' id='ver-adjuntos' data-id=\"" + model.id_solicitud + "\"><i class='glyphicon glyphicon-folder-open' aria-hidden='true'></i></a>").Titled("Solicitud").AppendCss("celda-grande").Encoded(false);
                                //columns.Add(model => " <a title='Ver Cotizaciones.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_AdjuntosCotizaciones", "SolicitudesClienteExterno") + "\");' class='abrirEnlace' id='ver-adjuntos-cotizaciones' data-id=\"" + model.id_solicitud + "\"><i class='glyphicon glyphicon-folder-open' aria-hidden='true'></i></a>").Titled("Cotizaciones").AppendCss("celda-grande").Encoded(false);
                                //columns.Add(model => "<a class='abrirEnlace' title='Ver Cotizaciones.' onclick='location.href=\"" + @Url.Action("Index", "Cotizacion", new { codigoCotizacion = model.codigo_cotizacion }) + "\";'><i class='fa fa-folder-open-o' aria-hidden='true'></i> Cotizaciones.</a>").Titled("Cotizaciones").AppendCss("celda-grande").Encoded(false);

                                columns.Add(model => /*"<button style='background-color:#00AD8E;border-color: #00AD8E;' class='btn btn-success' onclick='location.href=\"" + @Url.Action("Edit", "Solicitud", new { id = model.id_solicitud }) + "\"' id='editar' data-id=\"" + model.id_solicitud + "\"><span class='glyphicon glyphicon-pencil' aria-hidden='true'></span></button>" +*/
                                                     //"<a title='Asignación a usuarios.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_AsignacionUsuarios", "SolicitudesClienteExterno") + "\");' style='cursor: pointer;background-color:#ccc;border-color:#ccc;' class='btn btn-danger' id='asignacion-usuarios' data-id=\"" + model.id_solicitud + "\"><i style='color: black;' class='fa fa-user-plus' aria-hidden='true'></i></a>" +

                                                    " <a data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_codigo_cotizacion + "},\"" + @Url.Action("_AprobacionCotizacion", "SolicitudesClienteExterno") + "\");' style=" + (!model.id_codigo_cotizacion.HasValue || Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-APRO-COTIZ").Equals("ocultar-accion-catalogo") ? "'display:none'" : "") + "'cursor: pointer;background-color:#FF5E00;border-color:#FF5E00;' class='btn btn-danger " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-APRO-COTIZ") + "' id='aprobarCodigoCotizacion' data-id=\"" + model.id_codigo_cotizacion + "\"><i class='glyphicon glyphicon-random' aria-hidden='true'></i></a>" +
                                                    "<a title='Ver tracking proyecto.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({nombreProyecto: \"" + (model.NombreProyectoCodigoCotizacion ?? "") + "\", id:" + (model.id_codigo_cotizacion ?? 0) + "},\"" + @Url.Action("_TrackingProyecto", "SolicitudesClienteExterno") + "\");' style=" + (!model.id_codigo_cotizacion.HasValue || Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-TRACK-PROY").Equals("ocultar-accion-catalogo") ? "'display:none'" : "") + "'cursor: pointer;background-color:#FFC52D;border-color:#FFC52D;' class='btn btn-danger " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-TRACK-PROY") + "' id='asignacion-usuarios' data-id=\"" + model.id_solicitud + "\"><i style='color: black;' class='fa fa-line-chart' aria-hidden='true'></i></a>" +
                                                    " <a title='Comentarios.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_Comentario", "SolicitudesClienteExterno") + "\");' style='cursor: pointer;background-color:#ccc;border-color:#ccc;' ' class='btn btn-danger " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-COMENTARIO") + " id='comentario-solicitud' data-id=\"" + model.id_solicitud + "\"><i style='color: black;' class='fa fa-commenting-o' aria-hidden='true'></i></a>" +
                                                    "<a title='Ver Solicitud.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + model.id_solicitud + "},\"" + @Url.Action("_ImprimirSolicitud", "SolicitudesClienteExterno") + "\");' style='cursor: pointer;background-color:#00AD8E;border-color:#00AD8E;' ' class='btn btn-danger " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-IMPRIMIRSOL") + " id='ver-solicitud' data-id=\"" + model.id_solicitud + "\"><i style='color: black;' class='glyphicon glyphicon-print' aria-hidden='true'></i></a>" +
                                                    "<a title='Historial detalles de Proyecto.' data-backdrop='static' data-toggle='modal' data-target='#contenido-modal' onclick='_GetCreate({id:" + (model.id_codigo_cotizacion ?? 0) + "},\"" + @Url.Action("_HistorialDetalleAsignacionProyecto", "SolicitudesClienteExterno") + "\");' style=" + (!model.id_codigo_cotizacion.HasValue || Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-HIST-PROY").Equals("ocultar-accion-catalogo") ? "'display:none'" : "") + "'cursor: pointer;background-color:#FF5E00;border-color:#FF5E00;' class='btn btn-danger " + Auxiliares.GestionBontonesGrid(acciones, "ACCIONES-SIST-01-HIST-PROY") + "' id='asignacion-usuarios' data-id=\"" + model.id_solicitud + "\"><i style='color: black;' class='fa fa-list-ol' aria-hidden='true'></i></a>"

                                                //"<button title='Crear Código de Cotización.' style='background-color:#00B5E6;border-color: #00B5E6;' class='btn btn-success' onclick='location.href=\"" + @Url.Action("Edit", "CodigoCotizacion", new { id = model.id_codigo_cotizacion, solicitudID = model.id_solicitud }) + "\"' id='crear-codigo-cotizacion' data-id=\"" + model.id_codigo_cotizacion + "\"><span class='glyphicon glyphicon-file'></span></button>" +
                                                //"<button title='Eliminar.' onclick='ConfirmarEliminacion_(" + model.id_solicitud + ",\"" + @Url.Action("Eliminar", "CostoSublineaNegocio") + "\");' background-color:#FF5E00;border-color:#FF5E00;' class='btn btn-danger' id='eliminar' data-id=\"" + model.id_solicitud + "\"><span class='glyphicon glyphicon-trash' aria-hidden='true'></span></button>"

                                                ).Encoded(false);
                            })
                            //.RowAttributed(model => new { data_id = model.CuerpoCorreo })
                            .RowAttributed(model => new { @class = model.Urgente ? "SolicitudFilaUrgente" : string.Empty })
                            .Empty(Mensajes.MensajeNoDataListado)
                            .Id("grid-SolicitudesClienteExterno")
                            .Pageable(pager =>
                            {
                                pager.PagesToDisplay = 5;
                                pager.RowsPerPage = 10;
                            })
                            .Filterable()
                            .Sortable())
